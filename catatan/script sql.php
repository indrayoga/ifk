SELECT a.kd_obat,ifnull(b.jumlah_masuk,0) as jml_masuk,ifnull(c.jumlah_keluar,0) as jml_keluar, (ifnull(b.jumlah_masuk,0) - ifnull(c.jumlah_keluar,0) ) as total from master_obat a left join (select kd_obat,sum(jumlah) as jumlah_masuk from obat_masuk j, nota_masuk_obat k, jenis_stok_obat l where j.no_nota=k.no_nota and k.kd_jns_stok=l.kd_jns_stok and k.tgl_nota >='2009-08-01' and k.tgl_nota <='2009-08-23' and k.kd_jns_stok='2' group by kd_obat ) as b on a.kd_obat=b.kd_obat left join (select kd_obat,sum(jumlah) as jumlah_keluar from obat_keluar m, nota_keluar_obat n, jenis_stok_obat o where m.no_nota=n.no_nota and n.kd_jns_stok=o.kd_jns_stok and n.tgl_nota >='2009-08-01' and n.tgl_nota <='2009-08-23' and n.kd_jns_stok='2' group by m.kd_obat ) as c on a.kd_obat=c.kd_obat limit 0,25;

pencariaan stok awal

LEFT JOIN (select kd_obat,sum(jumlah) as jumlah_masuk_awal from obat_masuk j1, nota_masuk_obat k1, jenis_stok_obat l1 where j1.no_nota=k1.no_nota and k1.kd_jns_stok=l1.kd_jns_stok and   k1.tgl_nota >=d.tgl_nota and k1.tgl_nota < '$tgl_awal' and k1.kd_jns_stok='$stok' group by j1.kd_obat ) as f on a.kd_obat=f.kd_obat 
				LEFT JOIN (select kd_obat,sum(jumlah) as jumlah_keluar_awal from obat_keluar m1, nota_keluar_obat n1, jenis_stok_obat o1 where m1.no_nota=n1.no_nota and n1.kd_jns_stok=o1.kd_jns_stok and n.tgl_nota >= d.tgl_nota and n1.tgl_nota < '$tgl_awal'  and n.kd_jns_stok='$stok' group by m.kd_obat ) as g on a.kd_obat=g.kd_obat 
